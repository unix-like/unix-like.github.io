<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl"/>
  
  
  

  
  <title>rsync安装配置实例 | Linux运维装逼指南</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="本文详细介绍了rsync安装配置实例。">
<meta name="keywords" content="rsync">
<meta property="og:type" content="article">
<meta property="og:title" content="rsync安装配置实例">
<meta property="og:url" content="http://www.unix-like.com/2017/05/26/service/rsync安装配置实例/index.html">
<meta property="og:site_name" content="Linux运维装逼指南">
<meta property="og:description" content="本文详细介绍了rsync安装配置实例。">
<meta property="og:updated_time" content="2017-05-26T02:59:01.565Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="rsync安装配置实例">
<meta name="twitter:description" content="本文详细介绍了rsync安装配置实例。">
  
    <link rel="alternative" href="/atom.xml" title="Linux运维装逼指南" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
  <link rel="stylesheet" href="/css/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: true
      }
  </script>
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <script src="/js/require-2.1.6-jquery-1.9.1.min.js"></script>
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/avatar.png" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">Linux运维装逼指南</a></h1>
        </hgroup>

        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder=" Search...">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>

                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a rel="external nofollow" href="/archives/">所有文章</a></li>
                        
                            <li><a rel="external nofollow" href="/categories/database">数据库</a></li>
                        
                            <li><a rel="external nofollow" href="/categories/python">编程</a></li>
                        
                            <li><a rel="external nofollow" href="/categories/system">操作系统</a></li>
                        
                            <li><a rel="external nofollow" href="/categories/security">安全</a></li>
                        
                            <li><a rel="external nofollow" href="/categories/service">应用服务</a></li>
                        
                            <li><a rel="external nofollow" href="/about/">关于我</a></li>
                        
                            <li><a rel="external nofollow" href="/categories/life">生活随笔</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github" rel="external nofollow" target="_blank" href="https://github.com/unix-like" title="github">github</a>
                            
                                <a class="fl rss" rel="external nofollow" target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>

                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/bash/" style="font-size: 20px;">bash</a> <a href="/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/rsync/" style="font-size: 10px;">rsync</a> <a href="/tags/samba/" style="font-size: 10px;">samba</a> <a href="/tags/tc/" style="font-size: 10px;">tc</a> <a href="/tags/字符集/" style="font-size: 10px;">字符集</a> <a href="/tags/职业/" style="font-size: 20px;">职业</a> <a href="/tags/调优/" style="font-size: 20px;">调优</a>
                    </div>
                </section>
                

                

                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">一个做运维的人!</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Linux运维装逼指南</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/avatar.png" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Linux运维装逼指南</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/categories/database">数据库</a></li>
                
                    <li><a href="/categories/python">编程</a></li>
                
                    <li><a href="/categories/system">操作系统</a></li>
                
                    <li><a href="/categories/security">安全</a></li>
                
                    <li><a href="/categories/service">应用服务</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                    <li><a href="/categories/life">生活随笔</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/unix-like" title="github">github</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-service/rsync安装配置实例" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a rel="external nofollow" href="/2017/05/26/service/rsync安装配置实例/" class="article-date">
      <time datetime="2017-05-26T02:48:58.000Z" itemprop="datePublished">2017-05-26</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      rsync安装配置实例
    </h1>
  


      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/service/">service</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rsync/">rsync</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>本文详细介绍了rsync安装配置实例。<br><a id="more"></a></p>
<h1 id="一-安装rsync"><a href="#一-安装rsync" class="headerlink" title="一. 安装rsync"></a>一. 安装rsync</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install rsync</div></pre></td></tr></table></figure>
<h1 id="二-配置rsync服务器端"><a href="#二-配置rsync服务器端" class="headerlink" title="二. 配置rsync服务器端"></a>二. 配置rsync服务器端</h1><h3 id="1、-修改rsync的配置文件"><a href="#1、-修改rsync的配置文件" class="headerlink" title="1、  修改rsync的配置文件"></a>1、  修改rsync的配置文件</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">cat /etc/xinetd.d/rsync</div><div class="line"></div><div class="line"><span class="comment"># default: off</span></div><div class="line"><span class="comment"># description: The rsync server is a good addition to an ftp server, as it \</span></div><div class="line"><span class="comment">#   allows crc checksumming etc.</span></div><div class="line">service rsync</div><div class="line">&#123;</div><div class="line">    <span class="built_in">disable</span> = yes</div><div class="line">    flags           = IPv6</div><div class="line">    socket_type     = stream</div><div class="line">    <span class="built_in">wait</span>            = no</div><div class="line">    user            = root</div><div class="line">    server          = /usr/bin/rsync</div><div class="line">    server_args     = --daemon</div><div class="line">    log_on_failure  += USERID</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>　　可以看到rysnc服务是关闭的(disable = yes)，这里把它开启，把disable的值改为no</p>
<h3 id="2、-创建rsync服务器配置文件-etc-rsyncd-conf"><a href="#2、-创建rsync服务器配置文件-etc-rsyncd-conf" class="headerlink" title="2、  创建rsync服务器配置文件/etc/rsyncd.conf"></a>2、  创建rsync服务器配置文件/etc/rsyncd.conf</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">vim /etc/rsyncd.conf</div><div class="line"></div><div class="line">uid = root</div><div class="line">gid = root</div><div class="line">port = 873                                      <span class="comment">#　指定运行端口，默认是873，您可以自己指定</span></div><div class="line">hosts allow = 192.168.0.204, 192.168.1.205      <span class="comment"># 允许访问的客户机</span></div><div class="line"><span class="comment">#hosts deny = 0.0.0.0/32                        #　拒绝访问的</span></div><div class="line">use chroot = </div><div class="line">max connections = </div><div class="line">timeout=</div><div class="line"></div><div class="line"><span class="comment"># 下面这些文件是安装完RSYNC服务后自动生成的文件,当然也可以手动配置到指定路径</span></div><div class="line"></div><div class="line">pid file = /var/run/rsyncd.pid      <span class="comment">#pid文件的存放</span></div><div class="line">lock file = /var/run/rsync.lock     <span class="comment">#锁文件的存放位置</span></div><div class="line"><span class="built_in">log</span> file = /var/<span class="built_in">log</span>/rsyncd.log      <span class="comment">#日志记录文件的存放</span></div><div class="line">motd file = /etc/rsyncd.motd        <span class="comment">#欢迎</span></div><div class="line"></div><div class="line"><span class="comment"># 上面这段是全局配置，下面的模块可以有</span></div><div class="line"></div><div class="line">[<span class="built_in">test</span>]                                        <span class="comment"># 模块名字，自己命名</span></div><div class="line">path = /home/hyj/workspace/<span class="built_in">test</span>               <span class="comment"># 指定文件目录所在位置，这是必须指定 </span></div><div class="line">comment = rsync files                         <span class="comment"># 注释</span></div><div class="line">ignore errors                                 <span class="comment"># 忽略IO</span></div><div class="line"><span class="built_in">read</span> only = yes </div><div class="line">list = no                                     <span class="comment"># 是否把rsync 服务器上提供同步数据的目录显示</span></div><div class="line">auth users = rsync                            <span class="comment"># 同步验证时用的账号，如果没有这项就是匿名同步，client同步时不用用户名也能同步。</span></div><div class="line">secrets file = /etc/rsync.passwd              <span class="comment"># 指定认证文件</span></div></pre></td></tr></table></figure>
<h3 id="3、-创建认证文件："><a href="#3、-创建认证文件：" class="headerlink" title="3、  创建认证文件："></a>3、  创建认证文件：</h3><h4 id="3-1-创建认证文件"><a href="#3-1-创建认证文件" class="headerlink" title="3.1. 创建认证文件"></a>3.1. 创建认证文件</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">vim /etc/rsync.passwd</div><div class="line"></div><div class="line">rsync:hyl            <span class="comment"># 用户名：密码。注意这个不是系统用户，只是rsync用户。所以不用useradd。</span></div></pre></td></tr></table></figure>
<p>　　名字随便写，只要和上边配置文件里的“auth users”参数一致即可，格式(一行一个用户)账号：密码</p>
<h4 id="3-2-修改认证文件权限"><a href="#3-2-修改认证文件权限" class="headerlink" title="3.2. 修改认证文件权限"></a>3.2. 修改认证文件权限</h4><p>　　把认证文件的权限改成600</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod 600 /etc/rsync.passwd          <span class="comment">## 只能所有者可读，否则报错</span></div></pre></td></tr></table></figure>
<h3 id="4、-欢迎信息"><a href="#4、-欢迎信息" class="headerlink" title="4、 欢迎信息"></a>4、 欢迎信息</h3><p>　　如果在配置文件中指定了欢迎信息，在/etc下创建rsyncd.motd，设置欢迎信息：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">vim /etc/rsyncd.motd</div><div class="line"></div><div class="line">      Welcome the rsync services!</div></pre></td></tr></table></figure>
<h1 id="三-启动rsync"><a href="#三-启动rsync" class="headerlink" title="三. 启动rsync"></a>三. 启动rsync</h1><h3 id="1、-在server端将rsync启动："><a href="#1、-在server端将rsync启动：" class="headerlink" title="1、 在server端将rsync启动："></a>1、 在server端将rsync启动：</h3><h4 id="1-1-启动rsync服务端（以守护进程形式，独立启动）"><a href="#1-1-启动rsync服务端（以守护进程形式，独立启动）" class="headerlink" title="1.1 启动rsync服务端（以守护进程形式，独立启动）"></a>1.1 启动rsync服务端（以守护进程形式，独立启动）</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/rsync --daemon</div></pre></td></tr></table></figure>
<h4 id="1-2-启动rsync服务端-（以xinetd超级进程启动）"><a href="#1-2-启动rsync服务端-（以xinetd超级进程启动）" class="headerlink" title="1.2 启动rsync服务端 （以xinetd超级进程启动）"></a>1.2 启动rsync服务端 （以xinetd超级进程启动）</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/etc/rc.d/init.d/xinetd reload(reload是网上的说法，但是我试了一下报错，start可以)</div></pre></td></tr></table></figure>
<h3 id="2、-防火墙设置："><a href="#2、-防火墙设置：" class="headerlink" title="2、 防火墙设置："></a>2、 防火墙设置：</h3><p>　　如果服务器上装有防火墙，需在服务器中设置iptables将837端口开放。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -A INPUT -p tcp --dport 873 -j ACCEPT</div></pre></td></tr></table></figure>
<h1 id="四-配置rsync客户端"><a href="#四-配置rsync客户端" class="headerlink" title="四. 配置rsync客户端"></a>四. 配置rsync客户端</h1><h3 id="1、用安装服务器端的方式安装rsync。"><a href="#1、用安装服务器端的方式安装rsync。" class="headerlink" title="1、用安装服务器端的方式安装rsync。"></a>1、用安装服务器端的方式安装rsync。</h3><p>　　启动rsync，如果报如下错误，是因为在etc下没有rsyncd.conf配置文件：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rsync --daemon</div><div class="line">Failed to parse config file: /etc/rsyncd.conf</div></pre></td></tr></table></figure>
<p>　　创建配置文件 <code>/etc/rsyncd.conf</code> 文件内容为空就行。然后启动rsync，可以启动</p>
<h3 id="2、Rsync的命令格式可以为以下六种："><a href="#2、Rsync的命令格式可以为以下六种：" class="headerlink" title="2、Rsync的命令格式可以为以下六种："></a>2、Rsync的命令格式可以为以下六种：</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">　　rsync [OPTION]... SRC DEST</div><div class="line">　　rsync [OPTION]... SRC [USER@]HOST:DEST</div><div class="line">　　rsync [OPTION]... [USER@]HOST:SRC DEST</div><div class="line">　　rsync [OPTION]... [USER@]HOST::SRC DEST</div><div class="line">　　rsync [OPTION]... SRC [USER@]HOST::DEST</div><div class="line">　　rsync [OPTION]... rsync://[USER@]HOST[:PORT]/SRC [DEST]</div></pre></td></tr></table></figure>
<p>　　常用为以下两种：</p>
<h4 id="第一种："><a href="#第一种：" class="headerlink" title="第一种："></a>第一种：</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsync [OPTION]... [USER@]HOST::SRC   DEST</div></pre></td></tr></table></figure>
<p>　　从远程rsync服务器中拷贝文件到本地机。当SRC路径信息包含”::”分隔符时启动该模式。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">如：rsync -av root@172.16.78.192::www /databack</div></pre></td></tr></table></figure>
<h4 id="第二种："><a href="#第二种：" class="headerlink" title="第二种："></a>第二种：</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsync [OPTION]... SRC   [USER@]HOST::DEST</div></pre></td></tr></table></figure>
<p>　　从本地机器拷贝文件到远程rsync服务器中。当DST路径信息包含”::”分隔符时启动该模式。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">如：rsync -av /databack root@172.16.78.192::www</div></pre></td></tr></table></figure>
<h3 id="3、下面为实例："><a href="#3、下面为实例：" class="headerlink" title="3、下面为实例："></a>3、下面为实例：</h3><p>　　服务器ip为192.168.8.126，客户端ip为192.168.8.122</p>
<p>　　(1)、把服务器上的/home/hyj/workspace/test文件夹中的内容备份到客户端的/usr/local/share/rsync_backup中:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/rsync -vzrtopg --delete  --progress rsync@192.168.8.126::<span class="built_in">test</span> /usr/<span class="built_in">local</span>/share/rsync_backup</div></pre></td></tr></table></figure>
<p>　　<code>/etc/rsyncd.conf</code> 中模块的内容：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[<span class="built_in">test</span>]</div><div class="line">path = /home/hyj/workspace/<span class="built_in">test</span></div><div class="line">comment = rsync files</div><div class="line">ignore errors</div><div class="line"><span class="built_in">read</span> only = yes</div><div class="line">list = no</div><div class="line">auth users = rsync</div><div class="line">secrets file = /etc/rsync.passwd</div></pre></td></tr></table></figure>
<p>　　上面这个命令行中-vzrtopg里的v是verbose，z是压缩，r是recursive，topg都是保持文件原有属性如属主、时间的参数（也可以用直接用a来代替rtopg， a为 –archive 归档模式，表示以递归方式传输文件，并保持所有文件属性，等于-rlptgoD）。–progress是指显示出详细的进度情况，–delete是指如果服务器端删除了这一文件，那么客户端也相应把文件删除，保持真正的一致。</p>
<p>　　（2）、上面的命令需要在备份的时候需要输入密码，可以在客户端建立一个密码文件，在命令中把密码文件作为参数带入：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">vim /etc/rsync.passwd</div><div class="line"></div><div class="line">hyl</div></pre></td></tr></table></figure>
<p>　　密码文件中不用输入用户名，只需输入密码即可。</p>
<p>　　这份密码文件权限属性要设得只有root可读，不然会报错，修改属性：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod 600 /etc/rsync.passwd</div></pre></td></tr></table></figure>
<p>　　用下面这条命令，可以不输入密码：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/rsync -vzrtopg --delete  --progress --password-file=/etc/rsync.passwd rsync@192.168.8.126::<span class="built_in">test</span> /usr/<span class="built_in">local</span>/share/rsync_backup</div></pre></td></tr></table></figure>
<p>　　(3)、 带exclude 参数</p>
<p>　　把服务器上的/home/hyj/workspace/test文件夹中的内容备份到客户端的/usr/local/share/rsync_backup中，但不包括:res目录和default.properties文件：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/rsync -vzrtopg --delete --exclude <span class="string">"res/"</span> --exclude <span class="string">"default.properties"</span> --progress --password-file=/etc/rsync.passwd rsync@192.168.8.126::<span class="built_in">test</span> /usr/<span class="built_in">local</span>/share/rsync_backup</div></pre></td></tr></table></figure>
<p><strong> exclude/include规则实例 </strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Here are some exclude/include examples:</div><div class="line"> --exclude <span class="string">"*.o"</span>   would exclude all filenames matching *.o</div><div class="line"> --exclude <span class="string">"/foo"</span>  would exclude a file <span class="keyword">in</span> the base directory called foo</div><div class="line"> --exclude <span class="string">"foo/"</span>  would exclude any directory called foo.</div><div class="line"> --exclude <span class="string">"/foobar"</span> would exclude any file called bar two or more levels below a base directory called foo.</div><div class="line"> --include <span class="string">"*/"</span> --include <span class="string">"*.c"</span> --exclude <span class="string">"*"</span> would include all directories and C <span class="built_in">source</span> files</div><div class="line">--include <span class="string">"foo/"</span> --include <span class="string">"foo/bar.c"</span> --exclude <span class="string">"*"</span> would include only foo/bar.c</div><div class="line"> (the foo/ directory must be explicitly included or it would be excluded by the <span class="string">"*"</span>)</div></pre></td></tr></table></figure>
<p>　　(4)、 把客户端上的/home/hyj/vitest文件夹中的内容备份到服务器的/usr/local/share/rsync_backup中，在客户端执行如下命令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/rsync -vzrtopg --delete --progress --password-file=/etc/rsync.passwd /home/hyj/vitest rsync@192.168.8.126::clientdata</div></pre></td></tr></table></figure>
<p>　　此时服务器的配置文件/etc/rsyncd.conf内容为:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">uid = root</div><div class="line">gid = root</div><div class="line">hosts allow = 192.168.8.122, 192.168.8.123</div><div class="line"><span class="comment">#hosts deny = 0.0.0.0/32</span></div><div class="line">use chroot = no</div><div class="line">max connections = 10</div><div class="line">pid file = /var/run/rsyncd.pid</div><div class="line">lock file = /var/run/rsync.lock</div><div class="line"><span class="built_in">log</span> file = /var/<span class="built_in">log</span>/rsyncd.log</div><div class="line">timeout=600</div><div class="line"></div><div class="line">[<span class="built_in">test</span>]</div><div class="line">path = /home/hyj/workspace/<span class="built_in">test</span></div><div class="line">comment = rsync files</div><div class="line">ignore errors</div><div class="line"><span class="built_in">read</span> only = yes</div><div class="line">list = no</div><div class="line">auth users = rsync</div><div class="line">secrets file = /etc/rsync.passwd</div><div class="line"></div><div class="line"> <span class="comment"># 上面的命令中，客户端的数据备份到clientdata模块中，备份到/usr/local/share/rsync_backup文件夹下，read only改为no，# # 否则会报 `ERROR: module is read only` 的错误</span></div><div class="line"></div><div class="line">[clientdata]</div><div class="line">path = /usr/<span class="built_in">local</span>/share/rsync_backup</div><div class="line">comment = rsync files</div><div class="line">ignore errors</div><div class="line"><span class="built_in">read</span> only = no</div><div class="line">list = no</div><div class="line">auth users = rsync</div><div class="line">secrets file = /etc/rsync.passwd</div></pre></td></tr></table></figure>
<h1 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h1><h3 id="1、我需要在防火墙上开放哪些端口以适应rsync？"><a href="#1、我需要在防火墙上开放哪些端口以适应rsync？" class="headerlink" title="1、我需要在防火墙上开放哪些端口以适应rsync？"></a>1、我需要在防火墙上开放哪些端口以适应rsync？</h3><p>　　视情况而定</p>
<p>　　rsync可以直接通过873端口的tcp连接传文件，也可以通过22端口的ssh来进行文件传递，但你也可以通过下列命令改变它的端口：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rsync --port 8730 otherhost::</div><div class="line">或者</div><div class="line">rsync <span class="_">-e</span> <span class="string">'ssh -p 2002'</span> otherhost:</div></pre></td></tr></table></figure>
<h3 id="2、-我如何通过rsync只复制目录结构，忽略掉文件呢？"><a href="#2、-我如何通过rsync只复制目录结构，忽略掉文件呢？" class="headerlink" title="2、 我如何通过rsync只复制目录结构，忽略掉文件呢？"></a>2、 我如何通过rsync只复制目录结构，忽略掉文件呢？</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsync -av --include <span class="string">'*/'</span> --exclude <span class="string">'*'</span> <span class="built_in">source</span>-dir dest-dir</div></pre></td></tr></table></figure>
<h1 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rsync: failed to connect to 218.107.243.2: No route to host (113) </div><div class="line">rsync error: error <span class="keyword">in</span> socket IO (code 10) at clientserver.c(104) [receiver=2.6.9]</div></pre></td></tr></table></figure>
<p>　　解决：对方没开机、防火墙阻挡、通过的网络上有防火墙阻挡，都有可能。关闭防火墙，其实就是把tcp udp 的873端口打开：</p>
<hr>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">password file must not be other-accessible </div><div class="line">continuing without password file </div><div class="line">Password:</div></pre></td></tr></table></figure>
<p>　　解决：这是因为rsyncd.pwd rsyncd.sec的权限不对，应该设置为600。如：<code>chmod 600 rsyncd.pwd</code></p>
<hr>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@ERROR: auth failed on module xxxxx </div><div class="line">rsync: connection unexpectedly closed (90 bytes <span class="built_in">read</span> so far) </div><div class="line">rsync error: error <span class="keyword">in</span> rsync protocol data stream (code 12) at io.c(150)</div></pre></td></tr></table></figure>
<p>　　解决：这是因为密码设置错了，无法登入成功，检查一下rsync.pwd，看客服是否匹配。还有服务器端没启动rsync 服务也会出现这种情况。 </p>
<hr>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@ERROR: chroot failed </div><div class="line">rsync: connection unexpectedly closed (75 bytes <span class="built_in">read</span> so far) </div><div class="line">rsync error: error <span class="keyword">in</span> rsync protocol data stream (code 12) at io.c(150)</div></pre></td></tr></table></figure>
<p>　　解决：这是因为你在 rsync.conf 中设置的 path 路径不存在，要新建目录才能开启同步。 </p>
<hr>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[root@hyj rsync_backup]<span class="comment"># /usr/bin/rsync -vzrtopg --delete --exclude "res/" --exclude "default.properties" --progress rsync@192.168.8.126::test /usr/local/share/rsync_backup --password-file=/etc/rsync.pass</span></div><div class="line"></div><div class="line">@ERROR: <span class="built_in">chdir</span> failed</div><div class="line"></div><div class="line">rsync error: error starting client-server protocol (code 5) at main.c(1516) [Receiver=3.0.9]</div></pre></td></tr></table></figure>
<p>　　原因及解决办法：SELinux；（下面这条命令在服务器端执行）<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">setsebool -P rsync_disable_trans on</div></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ERROR: module is <span class="built_in">read</span> only</div><div class="line">rsync: <span class="built_in">read</span> error: Software caused connection abort (113)</div><div class="line">rsync error: error <span class="keyword">in</span> rsync protocol data stream (code 12) at io.c(769) [sender=3.0.8]</div></pre></td></tr></table></figure>
<p>　　解决：这是因为服务器端配置文件rsyncd.conf中read only = yes，为只读，即不允许客户端上传文件，改成no就可以了。</p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a rel="external nofollow" href="/2017/05/26/service/rsync安装配置实例/">rsync安装配置实例</a></p>
        <p><span>文章作者:</span><a rel="external nofollow" href="/" title="访问 Linux运维装逼指南 的个人博客">Linux运维装逼指南</a></p>
        <p><span>发布时间:</span>2017年05月26日 - 10时48分</p>
        <p><span>最后更新:</span>2017年05月26日 - 10时59分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/05/26/service/rsync安装配置实例/" title="rsync安装配置实例">http://www.unix-like.com/2017/05/26/service/rsync安装配置实例/</a>
            <span class="copy-path" data-clipboard-text="原文: http://www.unix-like.com/2017/05/26/service/rsync安装配置实例/　　作者: Linux运维装逼指南" title=""></span>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a rel="external nofollow" href="/2017/05/27/system/Linux上ssd优化/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          Linux上ssd优化
        
      </div>
    </a>
  
  
    <a rel="external nofollow" href="/2017/05/25/system/pdflush进程详解与优化/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">pdflush进程详解与优化</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>


  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一-安装rsync"><span class="toc-number">1.</span> <span class="toc-text">一. 安装rsync</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二-配置rsync服务器端"><span class="toc-number">2.</span> <span class="toc-text">二. 配置rsync服务器端</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、-修改rsync的配置文件"><span class="toc-number">2.0.1.</span> <span class="toc-text">1、  修改rsync的配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、-创建rsync服务器配置文件-etc-rsyncd-conf"><span class="toc-number">2.0.2.</span> <span class="toc-text">2、  创建rsync服务器配置文件/etc/rsyncd.conf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、-创建认证文件："><span class="toc-number">2.0.3.</span> <span class="toc-text">3、  创建认证文件：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-创建认证文件"><span class="toc-number">2.0.3.1.</span> <span class="toc-text">3.1. 创建认证文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-修改认证文件权限"><span class="toc-number">2.0.3.2.</span> <span class="toc-text">3.2. 修改认证文件权限</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、-欢迎信息"><span class="toc-number">2.0.4.</span> <span class="toc-text">4、 欢迎信息</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三-启动rsync"><span class="toc-number">3.</span> <span class="toc-text">三. 启动rsync</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、-在server端将rsync启动："><span class="toc-number">3.0.1.</span> <span class="toc-text">1、 在server端将rsync启动：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-启动rsync服务端（以守护进程形式，独立启动）"><span class="toc-number">3.0.1.1.</span> <span class="toc-text">1.1 启动rsync服务端（以守护进程形式，独立启动）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-启动rsync服务端-（以xinetd超级进程启动）"><span class="toc-number">3.0.1.2.</span> <span class="toc-text">1.2 启动rsync服务端 （以xinetd超级进程启动）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、-防火墙设置："><span class="toc-number">3.0.2.</span> <span class="toc-text">2、 防火墙设置：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四-配置rsync客户端"><span class="toc-number">4.</span> <span class="toc-text">四. 配置rsync客户端</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、用安装服务器端的方式安装rsync。"><span class="toc-number">4.0.1.</span> <span class="toc-text">1、用安装服务器端的方式安装rsync。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、Rsync的命令格式可以为以下六种："><span class="toc-number">4.0.2.</span> <span class="toc-text">2、Rsync的命令格式可以为以下六种：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#第一种："><span class="toc-number">4.0.2.1.</span> <span class="toc-text">第一种：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第二种："><span class="toc-number">4.0.2.2.</span> <span class="toc-text">第二种：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、下面为实例："><span class="toc-number">4.0.3.</span> <span class="toc-text">3、下面为实例：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FAQ"><span class="toc-number">5.</span> <span class="toc-text">FAQ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、我需要在防火墙上开放哪些端口以适应rsync？"><span class="toc-number">5.0.1.</span> <span class="toc-text">1、我需要在防火墙上开放哪些端口以适应rsync？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、-我如何通过rsync只复制目录结构，忽略掉文件呢？"><span class="toc-number">5.0.2.</span> <span class="toc-text">2、 我如何通过rsync只复制目录结构，忽略掉文件呢？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#常见错误"><span class="toc-number">6.</span> <span class="toc-text">常见错误</span></a></li></ol>
</div>
<style>
    .left-col .switch-btn {
        display: none;
    }
    .left-col .switch-area {
        display: none;
    }
</style>

<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="/js/require-2.1.6-jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }

    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
            $(".switch-btn, .switch-area").fadeOut(300);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
            $(".switch-btn, .switch-area").fadeIn(500);
        }
    })

    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
        $(".switch-btn, .switch-area").show();
    }
</script>








    



    <div class="scroll" id="post-nav-button">
        
            <a rel="external nofollow" href="/2017/05/27/system/Linux上ssd优化/" title="上一篇: Linux上ssd优化">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a rel="external nofollow" href="/2017/05/25/system/pdflush进程详解与优化/" title="下一篇: pdflush进程详解与优化">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/05/29/service/ Windows与Linux共享文件夹互相访问 /">Windows与Linux共享文件夹互相访问</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/28/life/系统运维工程师装逼完全指南/">系统运维工程师装逼完全指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/28/life/运维人装逼指南大全/">运维人装逼指南大全</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/28/service/tc命令Linux基于IP进行流量限速/">tc命令——Linux基于IP进行流量限速</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/27/system/Linux上ssd优化/">Linux上ssd优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/26/service/rsync安装配置实例/">rsync安装配置实例</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/25/system/pdflush进程详解与优化/">pdflush进程详解与优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/25/database/MongoDB归档及压缩工具/">MongoDB归档及压缩工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/25/system/Linux下清空或删除大文件内容的5种方法/">Linux下清空或删除大文件内容的5种方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/25/database/redis模糊删除key/">redis模糊删除key</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/25/system/Linux查看文件编码格式及文件编码转换/">Linux查看文件编码格式及文件编码转换</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/25/system/Bash历史中执行过的每一项命令设置时间和日期/">Bash历史中执行过的每一项命令设置时间和日期.md</a></li></ul>
    <script src="/js/require-2.1.6-jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        // $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#toc, .switch-btn, .switch-area").toggle();
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
                $(".switch-btn, .switch-area").fadeToggle(300);
            }
        })
    </script>




    <script>
        
    </script>

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2017 Linux运维装逼指南
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a><a href="https://github.com/maochunguang" target="_blank">Blog</a> by tommy
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >极客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="/css/require-2.1.6-jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 1;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>






<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>


<script async src="/js/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>